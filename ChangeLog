* 2007/03/30 Guy Martin <gmsoft@tuxicoman.be>
Added target_http.c. Fixed typo in target_pcap.c.
Fix segfaults in conntrack.c.
Added another safety check for the calculated payload_size.

* 2007/03/26 Guy Martin <gmsoft@tuxicoman.be>
Added sequence info and some type translation for echo.

* 2007/03/23 Guy Martin <gmsoft@tuxicoman.be>
Added output layer ipv4 to target_pcap.
Fixed cosmetic bug when calculating % of packet droppes in target_pcap.
Use input_docsis_read_mpeg_frame in input_docsis_check_downstream.
Changed max size claculation algo in rules.c.

* 2007/03/22 Guy Martin <gmsoft@tuxicoman.be>
Rewrote input_docsis to fix bug in docsis parsing algorithm.
Target pcap no longuer auto detect the right layer.
Added support for docsis layer to target_pcap.
Inputs now use struct input_functions.
Fixed length calculation of rtp payload in match_rtp.
Added match_docsis.

* 2007/03/19 Guy Martin <gmsoft@tuxicoman.be>
Fix fd_set initialisation in main.c.
Fix segfault if one match can't be loaded.

* 2007/03/18 Guy Martin <gmsoft@tuxicoman.be>
Fix segfault with malformed ipv4 fragment in helper_ipv4.
Improved error message in helper_ipv4.
Attach layer_info to layer sooner.
Fix error output of input_pcap.

* 2007/03/16 Guy Martin <gmsoft@tuxicoman.be>
input_open now returns a fd we can select() on.
Cleaned up match_linux_cooked.
Timers now use gettimeofday() instead of SIGALARM.
We now use select() before doing a read on the input.
Fix tricky size comparison bug in match_ipv6.c.
Added match_icmp by BoWRiS <bowris@mouh.be>.

* 2007/03/14 Guy Martin <gmsoft@tuxicoman.be>
Process the targets in the order that they are added.
Some more display fix in target_display.
Added custom snprintf function to match_icmpv6.

* 2007/03/09 Guy Martin <gmsoft@tuxicoman.be>
Some formating fix for target_display.
Avoid mem leak when input or config cannot be opened.
Fix recursive match registration.
Added match_icmpv6.
Better calulation of payload length in target_display.

* 2007/03/08 Guy Martin <gmsoft@tuxicoman.be>
FreeBSD fixes.
Fix segmentation fault with -h switch.
Added parameter to skip headers and change display mode for target_display.

* 2007/03/07 Guy Martin <gmsoft@tuxicoman.be>
Added support for the tcp flags in match_tcp.c.
Changed a bit the output of target_display to make it a bit clearer.
Fix stupid segfault when trying to display the help.
Some more code cleanup.

* 2007/03/04 Guy Martin <gmsoft@tuxicoman.be>
Changed the types of layer_info values.
Support custom snprintf functions for layer_info.
Added support for match_unregister function.
Make target_display work with non displaying info.

* 2007/03/03 Guy Martin <gmsoft@tuxicoman.be>
Changed layer_info value types.
Fixed a wrong cleanup algo in rules.c.
Don't forget to bzero the struct target in target.c.

* 2007/02/27 Guy Martin <gmsoft@tuxicoman.be>
Layer info are now registered at the same time than each match.
Added info to match_rtp, linux_cooked and some others.
Added match_type to the match_reg struct so match can have their number when registering.	

* 2007/02/17 Guy Martin <gmsoft@tuxicoman.be>
Updated README.
Updated copyright information.

* 2007/02/16 Guy Martin <gmsoft@tuxicoman.be>
Changed versio number to 'svn'.
Added parameter snaplen and removed first_layer from target_pcap. It automaticaly detect the first layer now.
Updated README.
Fixed setting of info in match_ipv6.
Rules now support more than one target.

* 2007/02/12 Guy Martin <gmsoft@tuxicoman.be>
Changed matches to to use struct match_functions.
Moved layer stuff out of match stuff.
Layers are now taken from a poll.
Added layer_info functions to allow match to parse the packet in a comprehensive way.
Cleanup of match_*.h files.
Fix typo in target_null.h.
Renamed match_cleanup in match_cleanup_module and add the first to clean the match general stuff.

* 2007/02/08 Guy Martin <gmsoft@tuxicoman.be>
Added match_linux_cooked and subsequent support in input_pcap.
Added first_layer parameter to target_pcap and added linux_cooked support.

* 2007/02/07 Guy Martin <gmsoft@tuxicoman.be>
Made example file and README be copied into docdir when doing make install.

* 2007/02/05 Guy Martin <gmsoft@tuxicoman.be>
Fixed compilation warnings on amd64.
Updated README with info on running the code.
Removed obsolete code in conntrack_udp.c and timers.c.
Removed and operation since it was useless and made a <or> tag.
Updated and documented example config.

* 2007/02/04 Guy Martin <gmsoft@tuxicoman.be>
Added missing r->flags to conntrack_udp and conntrack_tcp.
Fixed various copy/paste errors introduced while porting on BSD.
Make target_dump_payload allocate conntrack even if there is no payload to
catch reverse data.
Improved search of libraries.
Removed some cruft from debug output.

* 2007/02/02 Guy Martin <gmsoft@tuxicoman.be>
Fixed bug in target_tcpkill which was zeroing dest ipv4 addr in routed mode.
Improved input_docsis scanning and added parameters.
Make timers being initialized after input is open.
Get rid of pselect since SIGALARM will occure after input_open.

* 2007/02/01 Guy Martin <gmsoft@tuxicoman.be>
Check for pselect in configure.ac.
Fix syntax errors in helper_ipv4.c and main.c when debug is enabled.
Enable debug by default in Makefile.
Fix building of input_docsis.so.
Updated README file.
Merged autotools branch to trunk.

* 2007/01/28 Guy Martin <gmsoft@tuxicoman.be>
Changed static value of 255 to NAME_MAX for modules names.
Removed heading ./ for modules name to be able to use LD_LIBRARY_PATH.

* 2007/01/27 Guy Martin <gmsoft@tuxicoman.be>
Fixed includes for match_ethernet and timers on FreeBSD.
Fixed other remaining include problems on FreeBSD.
Various other build fix for FreeBSD.
Made target_{tcpkill,inject,tap} conditionnaly built.

* 2007/01/26 Guy Martin <gmsoft@tuxicoman.be>
Created new branch to include autotools support.
Made source code more portable thanks to Thomas Gouverneur <wildcat@espix.org>
for initial patch.

* 2007/01/15 Guy Martin <gmsoft@tuxicoman.be>
Fix typo in tcp_kill.c.
Add dependencies in the README.

* 2007/01/07 Guy Martin <gmsoft@tuxicoman.be>
Fix segfault in rules.c.

* 2007/01/06 Guy Martin <gmsoft@tuxicoman.be>
Changed name of struct layer* in all match_identify() to l.
Improved conf.c and rules.c to support multiple <node> in anyways.
Fixed conntrack_ipv6.
Fixed matching of conditional matches.
Added a \n for in the direction marks of target_dump_payload.

* 2007/01/03 Guy Martin <gmsoft@tuxicoman.be>
Some more in the README.

* 2007/01/02 Guy Martin <gmsoft@tuxicoman.be>
Added README file.
Added #ifdef DLT_DOCSIS in input_pcap tu support older version of pcap.
Fixed compilation warning of target_tcpkill.

* 2007/01/01 Guy Martin <gmsoft@tuxicoman.be>
Added a direction field to conntrack to reflect the direction of the packet.
Fixed length comparison in match_rtp.c.
Added a markdir param to target_dump_payload to show packet direction.

* 2006/12/31 Guy Martin <gmsoft@tuxicoman.be>
Fix payload size calculation in match_tcp, match_rtp and target_dump_payload.
Fix typo in rules.c.
Changed __uX to corresponding uintX_t.
Local copy of jhash.h from linux include.

* 2006/12/30 Guy Martin <gmsoft@tuxicoman.be>
Fix memory leak in rules.c.
Avoid deadlock with timer handling.

* 2006/12/29 Guy Martin <gmsoft@tuxicoman.be>
Changed main algo to first identify all the layers and then match.
Conntrack are now bidirectional. Support will improve soon.
Conntrack store target privs per target object instead of target_type.
Improved Makefile with targets clean_modules and modules.

* 2006/12/13 Guy Martin <gmsoft@tuxicoman.be>
Some more work to support bidir conntrack.
Don't forget to init the rules in main.c.
Fix bug when receiving IPv4 packets of invalid size.

* 2006/12/05 Guy Martin <gmsoft@tuxicoman.be>
Make conntrack use a conntrack_entry to reference a connection.
Fix target_wave for duplicate rtp packets.

* 2006/12/03 Arnaud Ligot <spyroux@spyroux.be>
Fixed ipv6 netmask support.
Added Flow label support.

* 2006/12/03 Guy Martin <gmsoft@tuxicoman.be>
Compute the ipv6 netmasks when parsing param.
Change the way that target passes functions to modules.
Don't make conntrack and helper init timers.

* 2006/11/25 Guy Martin <gmsoft@tuxicoman.be>
Make match_udp inclusive when looking for ports.
Initial helper implementation and helper IPv4.

* 2006/11/07 Guy Martin <gmsoft@tuxicoman.be>
Move the timer code out of conntrack for future helper use.

* 2006/11/05 Guy Martin <gmsoft@tuxicoman.be>
Make target tcpkill have ACK set into RST packet to kill new connections.
Fix sequence handling in target tcpkill.
Make the max conntrack be the same as the max matchs.

* 2006/10/18 Guy Martin <gmsoft@tuxicoman.be>
Make target tcpkill works as well for IPv6 tunneled in IPv4 connections in
normal and routed mode.
Fix typo in input pcap, load match undefined instead of undefined_id.

* 2006/10/17 Guy Martin <gmsoft@tuxicoman.be>
Changed snaplen of input pcap to 1522 to include ethernet with vlan.
Added conntrack ipv6.
Improve input pcap open error.
Improved target tcpkill to support two modes and IPv6.

* 2006/10/16 Guy Martin <gmsoft@tuxicoman.be>
Added target tcpkill.
Added match ipv6.
Fixed input_pcap.
Moved pom.xml.conf to pom.xml.conf.example.

* 2006/10/15 Guy Martin <gmsoft@tuxicoman.be>
Added get_first_layer() to all inputs.
Make do_rule() check the first match with the first layer.

* 2006/10/14 Guy Martin <gmsoft@tuxicoman.be>
Fix parameter parsing in target_dump_payload.
Use node_find_payload_size in target_dump_payload.
Added timers to conntrack_tcp.
Changed select into pselect in input_docsis to void interupted system call.

* 2006/10/11 Guy Martin <gmsoft@tuxicoman.be>
Fix compilation errors with newer kernel headers.
Fix variable endianess warnings.

* 2006/10/09 Guy Martin <gmsoft@tuxicoman.be>
Added useable text parameters to all modules.
Added xml config file support.
Added example config.
Removed unused config.c and config.h files.
Added options -c to specify the config file.
Added option -h to see inputs, targets and matchs parameters.

* 2006/10/01 Guy Martin <gmsoft@tuxicoman.be>
Do not abort but drop the packet if the buffer is too small in input_docsis.
Fix double rule processing in main.c.
Try to avoid to fail on initial locking in input_docis.

* 2006/09/29 Guy Martin <gmsoft@tuxicoman.be>
Fixed memory leak in target_wave.
Added missing match_rtp and conntrack_rtp in svn.
Entirely moved timer management to conntrack core.
Add header size checking for match_rtp.
Add some more len checking in when processing rules.
Fix bug in match_tcp for payload size calculation.

* 2006/09/27 Guy Martin <gmsoft@tuxicoman.be>
Added support for G.711U and G.722 in target_wave.

* 2006/09/26 Guy Martin <gmsoft@tuxicoman.be>
Added target_wave to save rtp payload.
Remove obsolete target_rtp.
Added node_find_payload_size() to get the exact payload size.
Fixed some debugging.
Fixed a bug when the next layer was undefined, it was not possible to have the
size of the next header.

* 2006/09/22 Guy Martin <gmsoft@tuxicoman.be>
Compute the size of each header's payload in next_size.
Remove the last printf for dprint.
Implement a timer for periodic timeout checking.
Added preliminary timeout support to conntack_udp and conntrack.c.
Fixed memory leaks.

* 2006/09/20 Guy Martin <gmsoft@tuxicoman.be>
More detailed drop statistics from input_docsis.
Fixed error detection in input_docsis.
Fixed setup of the demux buffer size.

* 2006/09/15 Guy Martin <gmsoft@tuxicoman.be>
Added target_dump_payload.
Continue to work on conntrack.
Fix next_start in match_tcp and match_udp.

* 2006/09/14 Guy Martin <gmsoft@tuxicoman.be>
Fixed conntrack_udp and added conntrack_tcp.

* 2006/09/13 Guy Martin <gmsoft@tuxicoman.be>
Added input_pcap.
Some more work on conntrack. Now compiles and conntrak_ipv4 is done.

* 2006/09/07 Guy Martin <gmsoft@tuxicoman.be>
Some work on conntrack.
